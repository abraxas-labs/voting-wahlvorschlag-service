@using Eawv.Service.DataAccess.Entities
@using RazorLight
@using System.Linq
@inherits TemplatePage<Eawv.Service.Models.TemplateServiceModels.TemplateBag>
@{
    ViewBag.Model = Model;
    Layout = "BaseLayoutHeader_Default";
    // show signature column only for lists not in draft state or pseudo lists                                                                       
    var showSignatureColumn = !Model.ListIsDraft || Model.List.IsNew;
}
<main>
<div class="row stretch">
    <div class="grow">
        @if (Model.IsProporz)
        {
            <div class="row space">
                <div class="row col-main">
                    <div>
                        <span><span class="bold">Bezeichnung</span> des Wahlvorschlags:</span>
                    </div>
                    <div class="grow col">
                        <div class="input">
                            <input value="@Model.List.Name" />
                            <div class="border"></div>
                        </div>
                    </div>
                </div>
            </div>
        }

        @if (Model.IsMajorz)
        {
            <div class="row space space-top">
                <div class="row col-main space">
                    <div class="flex">
                        <span class="bold">Eingang bei zuständiger Behörde</span> (bitte nicht ausfüllen):
                        <div class="input inline-input w-6">
                            <input value="" />
                            <div class="border"></div>
                        </div>
                        <div class="input inline-input w-4">
                            <input value="" />
                            <div class="border"></div>
                        </div>
                        Uhr
                    </div>
                    <div class="flex">
                        <div class="input inline-input w-6">
                            <input value="" />
                            <div class="border"></div>
                        </div>
                        Visum zuständige Behörde
                    </div>
                </div>
            </div>
        }


        @if (Model.IsProporz)
        {
            <div class="row space">
                <div class="row col-main">
                    <div>
                        Evtl. <span class="bold">Präzisierung</span> nach Alter,
                        Geschlecht, Region oder Parteiflügel:
                    </div>
                    <div class="input grow">
                        <input value="@Model.List.Description" />
                        <div class="border"></div>
                    </div>
                </div>
            </div>
            <div class="row col-main space">
                <div class="flex">
                    <span class="bold">Listennummer</span> (Bitte nicht ausfüllen, wird zugeteilt):
                    <div class="input inline-input w-4">
                        <input value="@Model.List.Indenture" />
                        <div class="border"></div>
                    </div>
                </div>
                <div class="flex">
                    Einreichedatum:
                    <div class="input inline-input w-6">
                            <input value="" />
                        <div class="border"></div>
                    </div>
                    <div class="input inline-input w-4">
                        <input value="" />
                        <div class="border"></div>
                    </div>
                    Uhr
                </div>
            </div>
        }
    </div>
</div>
<div>
    <div class="row space">
        <div class="row">
            <div>
                <h2 class="inline" id="table-heading">Kandidatur(en)</h2>
                @(Model.List.IsNew ? "(Bitte in Blockschrift ergänzen)" : "")
            </div>
        </div>
        @if (Model.IsProporz)
        {
            <span>Anzahl Sitze: @Model.ElectionNumberOfMandates</span>
        }
    </div>
    <table class="fullwidth" aria-describedby="table-heading">
        <thead>
        <tr>
            <th scope="col" rowspan="2">Nr.</th>
            <th scope="col" class="bot-no-border" style="width: 3cm">Name</th>
            <th scope="col" class="bot-no-border" style="width: 3cm">Vorname(n)</th>
            <th scope="col" rowspan="2">
                <span class="upright">Geschlecht (m/w)</span>
            </th>
            <th scope="col" colspan="3" class="bot-no-border">Geburtsdatum</th>
            <th scope="col" class="bot-no-border" style="width: 4cm;">Beruf</th>
            <th scope="col" colspan="3" class="bot-no-border">Adresse</th>
            <th scope="col" rowspan="2">Heimatort(e) inkl. Kantonszugehörigkeit</th>
            @if (Model.IsMajorz)
            {
                <th scope="col" rowspan="2" style="width: 3cm">
                    <span>Partei</span>
                </th>
            }
            <th scope="col" rowspan="2">
                <span class="upright">Bisher</span>
            </th>
            @if (showSignatureColumn)
            {
                <th scope="col" class="bot-no-border" style="width: 3.5cm">
                    Unterschrift<br/>der Kandidierenden
                </th>
            }
            <th scope="col" rowspan="2" style="width: .2cm">Kontrolle (leer lassen)</th>
        </tr>
        <tr class="top-no-border">
            <th scope="col" style="width: 3cm; white-space: nowrap;">
                <em>1. Zeile Amtlich</em><br />
                <em>2. Zeile Politisch</em>
            </th>
            <th scope="col" style="width: 3cm; white-space: nowrap;">
                <em>1. Zeile Amtlich</em><br />
                <em>2. Zeile Politisch</em>
            </th>
            <th scope="col">
                <span class="upright">Tag</span>
            </th>
            <th scope="col">
                <span class="upright">Monat</span>
            </th>
            <th scope="col">
                <span class="upright">Jahr</span>
            </th>
            <th scope="col" style="width: 3.5cm;">
                inkl. allfälliger Titel und weiterer Bezeichnungen für
                Stimmzettel
            </th>
            <th scope="col" style="width: 3cm;">Strasse/Nr.</th>
            <th scope="col">PLZ</th>
            <th scope="col" style="min-width: 2.4cm; white-space: nowrap;">
                <em>Wohnort<em><br />
                <em>1. Zeile Amtlich</em><br />
                <em>2. Zeile Politisch</em>
            </th>
            @if (showSignatureColumn)
            {
                <th scope="col">(eigenhändig)</th>
            }
        </tr>
        </thead>
        <tbody>
        @foreach (var candidate in Model.GetClonedAndOrderedCandidates())
        {
            <tr>
                <td class="filled right">@candidate.Index.ToString("D2")</td>
                @if (candidate.IsNew)
                {
                    <td>
                        <div style="border-bottom: 1px solid #999;"></div>
                        <div></div>
                    </td>
                    <td>
                        <div style="border-bottom: 1px solid #999;"></div>
                        <div></div>
                    </td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>
                        <div style="border-bottom: 1px solid #999;"></div>
                        <div></div>
                    </td>
                    <td></td>
                    <td></td>
                    @if (Model.IsMajorz)
                    {
                        <td></td>
                    }
                }
                else
                {
                    <td>
                        <div style="border-bottom: 1px solid #999;">@candidate.FamilyName</div>
                        <div>@candidate.BallotFamilyName</div>
                    </td>
                    <td>
                        <div style="border-bottom: 1px solid #999;">@candidate.FirstName</div>
                        <div>@candidate.BallotFirstName</div>
                    </td>
                    <td class="center">
                        @switch (candidate.Sex)
                        {
                            case SexType.Female:
                                <span>w</span>
                                break;
                            case SexType.Male:
                                <span>m</span>
                                break;
                        }
                    </td>
                    <td class="center">@candidate.DateOfBirth.Day</td>
                    <td class="center">@candidate.DateOfBirth.Month</td>
                    <td class="center">@candidate.DateOfBirth.Year</td>
                    <td>@(Model.Settings.ShowBallotPaperInfos ?
                              candidate.BallotOccupationalTitle :
                              string.IsNullOrWhiteSpace(candidate.Title) ?
                                  candidate.OccupationalTitle :
                                  $"{candidate.Title}, {candidate.OccupationalTitle}")</td>
                    <td>@candidate.Street @candidate.HouseNumber</td>
                    <td>@candidate.ZipCode</td>
                    <td>
                        <div style="border-bottom: 1px solid #999;">@candidate.Locality</div>
                        <div>@(string.IsNullOrWhiteSpace(candidate.BallotLocality) ? candidate.Locality : candidate.BallotLocality)</div>
                    </td>
                    <td>@candidate.Origin</td>
                    @if (Model.IsMajorz)
                    {
                        <td>@candidate.Party</td>
                    }
                    <!-- Bisher -->
                    <td class="center"><span class="@(candidate.Incumbent ? "checkbox-checked" : "checkbox-unchecked")"></span></td>
                }
                @if (showSignatureColumn)
                {
                    <td></td>
                }
                <td class="filled"></td>
            </tr>
        }
        </tbody>
    </table>
</div>
<div class="no-page-break">
    <div class="row space-bottom">
        <div class="w-12">Vertretung des Wahlvorschlags: </div>
        <div>
            <div class="input inline-input w-16">
                <input value="@Model.ListRepresentative?.Firstname @Model.ListRepresentative?.Lastname"/>
                <div class="border"></div>
            </div>
            E-Mail:
            <div class="input inline-input w-16">
                <input value="@Model.ListRepresentative?.Emails?.FirstOrDefault(e => e.Primary.Value)?.Email"/>
                <div class="border"></div>
            </div>
            Unterschrift:
            <div class="input inline-input w-16">
                <input />
                <div class="border"></div>
            </div>
        </div>
    </div>
    <div class="row space-bottom">
        <div class="w-12">Stellvertretung des Wahlvorschlags: </div>
        <div>
            <div class="input inline-input w-16">
                <input value="@Model.ListDeputy?.Firstname @Model.ListDeputy?.Lastname"/>
                <div class="border"></div>
            </div>
            E-Mail:
            <div class="input inline-input w-16">
                <input value="@Model.ListDeputy?.Emails?.FirstOrDefault(e => e.Primary.Value)?.Email"/>
                <div class="border"></div>
            </div>
            Unterschrift:
            <div class="input inline-input w-16">
                <input />
                <div class="border"></div>
            </div>
        </div>
    </div>
</div>
<div class="space-bottom preserve-whitespace">
@Model.GetInfoText("formCandidacies")
</div>
</main>